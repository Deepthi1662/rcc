import java.time.LocalDate;

public class FinancialYearQuarterFormatter {

    // Constants for the key values
    private static final String CURRENT_FINANCIAL_QUARTER = "Cur Qtr";
    private static final String PREVIOUS_FINANCIAL_QUARTER = "Prev Qtr";
    private static final String CURRENT_FINANCIAL_QUARTER_LAST_YEAR = "Cur Qtr Last Year";
    private static final String PREVIOUS_FINANCIAL_QUARTER_LAST_YEAR = "Prev Qtr Last Year";

    // Method to get the financial year and quarter in "Qx in this financial year YY-YY" format
    public static String getFormattedFinancialQuarter(String key) {
        // Get the current date (this will be dynamically used)
        LocalDate currentDate = LocalDate.now();  // Today's date

        // Get the current month and year
        int currentMonth = currentDate.getMonthValue();
        int currentYear = currentDate.getYear();
        int previousYear = currentYear - 1;

        // Determine the financial quarter based on the month
        int quarter = 0;

        // Financial year starts from April (month 4)
        if (currentMonth >= 4 && currentMonth <= 6) {
            quarter = 1;  // Q1: April - June
        } else if (currentMonth >= 7 && currentMonth <= 9) {
            quarter = 2;  // Q2: July - September
        } else if (currentMonth >= 10 && currentMonth <= 12) {
            quarter = 3;  // Q3: October - December
        } else if (currentMonth >= 1 && currentMonth <= 3) {
            quarter = 4;  // Q4: January - March
        }

        // Adjust financial year if the month is before April
        if (currentMonth < 4) {
            currentYear--;
            previousYear--;
        }

        // Get the short year values (last 2 digits of the year)
        String currentYearShort = String.valueOf(currentYear).substring(2);
        String previousYearShort = String.valueOf(previousYear).substring(2);

        // Handle the different cases based on the provided key
        return switch (key) {
            case CURRENT_FINANCIAL_QUARTER -> formatFinancialQuarter(quarter, currentYearShort, currentYearShort, "this");
            case PREVIOUS_FINANCIAL_QUARTER -> formatFinancialQuarter(quarter - 1 == 0 ? 4 : quarter - 1, currentYearShort, currentYearShort, "this");
            case CURRENT_FINANCIAL_QUARTER_LAST_YEAR -> formatFinancialQuarter(quarter, previousYearShort, previousYearShort, "last");
            case PREVIOUS_FINANCIAL_QUARTER_LAST_YEAR -> formatFinancialQuarter(quarter - 1 == 0 ? 4 : quarter - 1, previousYearShort, previousYearShort, "last");
            default -> null;  // Return null if no match
        };
    }

    // Helper function to format the financial quarter
    private static String formatFinancialQuarter(int quarter, String startYear, String endYear, String yearType) {
        return "Q" + quarter + " in " + yearType + " financial year " + startYear + "-" + endYear;
    }

    public static void main(String[] args) {
        // Test the method with different keys for today's date
        System.out.println(getFormattedFinancialQuarter(CURRENT_FINANCIAL_QUARTER));             // Example: "Q1 in this financial year 25-26" for current quarter
        System.out.println(getFormattedFinancialQuarter(PREVIOUS_FINANCIAL_QUARTER));           // Example: "Q4 in this financial year 24-25" for previous quarter
        System.out.println(getFormattedFinancialQuarter(CURRENT_FINANCIAL_QUARTER_LAST_YEAR));  // Example: "Q1 in last financial year 24-25" for current quarter last year
        System.out.println(getFormattedFinancialQuarter(PREVIOUS_FINANCIAL_QUARTER_LAST_YEAR)); // Example: "Q4 in last financial year 23-24" for previous quarter last year
    }
}
