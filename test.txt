@Repository
public interface RelationshipDetailsRepository extends JpaRepository<RelationshipDetails, String> {

    @Query("SELECT new com.example.CustomerProfileRv(rd.currentRv, cp.crn, cp.customerName, cp.creationDate) " +
           "FROM RelationshipDetails rd " +
           "JOIN CustomerProfile cp ON rd.crn = cp.crn " +
           "WHERE cp.familyId = :familyId")
    List<CustomerProfileRv> findRelationshipDetailsByFamilyId(@Param("familyId") String familyId);
}
